<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>æ¢“è¾°çš„åè¯­ä¹å›­</title>
    <style>
        :root {
            --primary: #FF9A9E; /* æ¸©æŸ”ç²‰ */
            --secondary: #a1c4fd; /* å¤©ç©ºè“ */
            --accent: #fbc2eb; /* äº®ç²‰ç‚¹ç¼€ */
            --text: #555;
            --bg-gradient: linear-gradient(135deg, #fdfbfb 0%, #ebedee 100%);
            --card-shadow: 0 8px 15px rgba(0,0,0,0.1);
        }

        body {
            font-family: 'Comic Sans MS', 'Microsoft YaHei', 'Rounded Mplus 1c', sans-serif;
            background: var(--bg-gradient);
            margin: 0;
            padding: 15px;
            min-height: 100vh;
            box-sizing: border-box;
            display: flex;
            justify-content: center;
            align-items: center;
        }

        .screen-container {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 30px;
            padding: 30px;
            width: 100%;
            max-width: 700px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.15);
            text-align: center;
            display: none; /* é»˜è®¤éšè— */
            animation: popIn 0.6s cubic-bezier(0.68, -0.55, 0.265, 1.55);
        }
        
        .screen-container.active { display: block; }

        @keyframes popIn {
            0% { transform: scale(0.8); opacity: 0; }
            100% { transform: scale(1); opacity: 1; }
        }

        h1, h2 { color: var(--primary); text-shadow: 1px 1px 2px rgba(0,0,0,0.1); margin-top: 0;}

        /* --- è€å¸ˆå½¢è±¡ (CSSè‡ªåŠ¨ç”Ÿæˆ) --- */
        .teacher-avatar {
            font-size: 100px;
            background: #fff0f5;
            width: 150px;
            height: 150px;
            line-height: 150px;
            border-radius: 50%;
            border: 6px solid var(--primary);
            margin: 0 auto 20px;
            box-shadow: var(--card-shadow);
            animation: float 3s ease-in-out infinite;
        }

        @keyframes float { 0%, 100% { transform: translateY(0); } 50% { transform: translateY(-10px); } }

        /* --- å¯¹è¯æ°”æ³¡ --- */
        .bubble {
            background: #fff;
            border: 3px solid var(--secondary);
            padding: 20px;
            border-radius: 25px;
            position: relative;
            font-size: 1.2em;
            color: var(--text);
            margin-bottom: 30px;
        }
        .bubble::after {
            content: ''; position: absolute; top: -15px; left: 50%; margin-left: -10px;
            border-width: 0 10px 15px; border-style: solid; border-color: transparent transparent var(--secondary);
        }

        /* --- é€šç”¨æŒ‰é’® --- */
        .btn {
            background: linear-gradient(to right, var(--primary), var(--accent));
            border: none; color: white; padding: 12px 30px; font-size: 1.3em;
            border-radius: 50px; cursor: pointer; transition: all 0.3s;
            box-shadow: 0 5px 15px rgba(255, 154, 158, 0.4);
        }
        .btn:hover { transform: translateY(-3px) scale(1.05); box-shadow: 0 8px 20px rgba(255, 154, 158, 0.6); }
        .btn:active { transform: scale(0.98); }

        /* --- å­¦ä¹ å¡ç‰‡ç½‘æ ¼ --- */
        .grid-layout {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(140px, 1fr));
            gap: 15px;
            margin-bottom: 20px;
        }
        .learn-card {
            background: white; border-radius: 20px; padding: 15px;
            box-shadow: var(--card-shadow); cursor: pointer;
            transition: all 0.3s; border: 3px solid transparent;
        }
        .learn-card:hover { transform: translateY(-5px); border-color: var(--secondary); }
        .learn-card.playing { border-color: var(--accent); animation: pulse 1s infinite; }
        .card-icon { font-size: 60px; display: block; margin-bottom: 5px; }
        .card-text { font-size: 1.3em; font-weight: bold; color: #444; margin: 5px 0; }
        .card-pinyin { font-size: 0.9em; color: #999; }

        /* --- æ¸¸æˆåŒºåŸŸé€šç”¨ --- */
        .game-panel {
            background: #f0f7ff; border-radius: 25px;
            padding: 25px; margin-top: 20px; border: 3px dashed var(--secondary);
        }
        .feedback-text { height: 30px; font-weight: bold; font-size: 1.2em; margin: 15px 0; }

        /* --- æ¸¸æˆ1ï¼šé€‰æ‹©é¢˜ --- */
        .quiz-image-box { font-size: 120px; margin-bottom: 20px; animation: float 4s ease-in-out infinite;}
        .quiz-options-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 15px; }
        .quiz-btn {
            background: white; border: 2px solid #ddd; padding: 15px;
            font-size: 1.2em; border-radius: 15px; cursor: pointer;
        }
        .quiz-btn.correct { background: #d4edda; border-color: #28a745; color: #155724; }
        .quiz-btn.wrong { background: #f8d7da; border-color: #dc3545; color: #721c24; }

        /* --- æ¸¸æˆ2ï¼šç»„å¥ --- */
        .sentence-container {
            display: flex; flex-wrap: wrap; justify-content: center; gap: 10px;
            min-height: 70px; padding: 10px; background: rgba(255,255,255,0.7);
            border-radius: 15px; border: 2px solid #e1e1e1; margin-bottom: 20px;
        }
        .word-tile {
            background: white; border: 2px solid var(--accent); padding: 8px 15px;
            border-radius: 12px; font-size: 1.1em; font-weight: bold; cursor: move;
            box-shadow: 0 3px 5px rgba(0,0,0,0.1); transition: transform 0.2s;
        }
        .word-tile:active { transform: scale(1.1); background: var(--accent); color: white;}

    </style>
</head>
<body>

    <div id="screen-intro" class="screen-container active">
        <div class="teacher-avatar">ğŸ‘©â€ğŸ«</div>
        <div class="bubble">
            â€œå—¨ï¼Œæ¢“è¾°ï¼æˆ‘æ˜¯ä½ çš„åè¯­å°è€å¸ˆã€‚<br>å¿«æ¥åŠ å…¥æˆ‘ä»¬çš„å¼€å­¦æ¢é™©å§ï¼å‡†å¤‡å¥½äº†å—ï¼Ÿâ€
        </div>
        <button class="btn" onclick="goToScreen('screen-learn')">æˆ‘å‡†å¤‡å¥½äº†ï¼å‡ºå‘ï¼ğŸš€</button>
    </div>

    <div id="screen-learn" class="screen-container">
        <h2>ğŸ“– ç‚¹ä¸€ç‚¹ï¼Œå¬å£°éŸ³</h2>
        <p style="color:#666">ç‚¹å¡ç‰‡å¬è€å¸ˆæ€ä¹ˆè¯»ï¼Œè¦è·Ÿç€å¿µå“¦ï¼</p>
        <div id="learn-grid" class="grid-layout">
            </div>
        <div class="bubble" style="margin-top: 20px; padding: 10px;">
            å­¦å®Œä¸Šé¢çš„è¯è¯­ï¼Œå°±æ¥æŒ‘æˆ˜æ¸¸æˆå§ï¼ğŸ‘‡
        </div>
        <button class="btn" onclick="startGame1()">å¼€å§‹ç©æ¸¸æˆï¼ğŸ®</button>
    </div>

    <div id="screen-game1" class="screen-container">
        <h2>ğŸ® æŒ‘æˆ˜ä¸€ï¼šçœ‹å›¾é€‰ä¸€é€‰</h2>
        <div class="game-panel">
            <div id="quiz-target-icon" class="quiz-image-box">â“</div>
            <div class="feedback-text" id="quiz1-feedback"></div>
            <div id="quiz-options-area" class="quiz-options-grid">
                </div>
        </div>
    </div>

    <div id="screen-game2" class="screen-container">
        <h2>ğŸ® æŒ‘æˆ˜äºŒï¼šå¥å­æ’æ’é˜Ÿ</h2>
        <p>ç‚¹ä¸€ç‚¹è¯è¯­ï¼ŒæŠŠå®ƒä»¬æ’æˆæ­£ç¡®çš„å¥å­ï¼š</p>
        <div class="game-panel">
            <div id="sentence-target" class="sentence-container" style="border-color: var(--accent);"></div>
            <div id="sentence-pool" class="sentence-container" style="background: transparent; border: none;"></div>
            
            <div class="feedback-text" id="quiz2-feedback"></div>
            <button class="btn" onclick="checkSentence()" style="font-size: 1em; padding: 10px 25px;">æˆ‘æ’å¥½äº†ï¼Œæ£€æŸ¥ï¼âœ…</button>
        </div>
    </div>

    <div id="screen-outro" class="screen-container">
        <div class="teacher-avatar">ğŸ‰</div>
        <h2>æ¢“è¾°çœŸæ£’ï¼æŒ‘æˆ˜æˆåŠŸï¼</h2>
        <div class="bubble">
            â€œä½ å¤ªå‰å®³äº†ï¼ä»Šå¤©å­¦äº†å¥½å¤šæ–°çŸ¥è¯†ã€‚<br>æˆ‘ä»¬ä¸‹æ¬¡å†è§å–½ï¼Œæ‹œæ‹œï¼ğŸ‘‹â€
        </div>
        <button class="btn" onclick="location.reload()" style="background: var(--secondary)">å†ç©ä¸€æ¬¡ ğŸ”„</button>
    </div>

    <script>
        // --- æ ¸å¿ƒæ•°æ® (åŸºäº PDF å†…å®¹ P1-P5) ---
        // ä½¿ç”¨ Emoji ä½œä¸ºè§†è§‰åŸºç¡€ï¼ŒCSS ä¼šè®©å®ƒä»¬çœ‹èµ·æ¥æ›´åƒå›¾æ ‡
        const lessonData = [
            // P1
            { id: 'p1_t1', type: 'word', text: 'è€å¸ˆ', pinyin: 'lÇo shÄ«', icon: 'ğŸ‘©â€ğŸ«' },
            { id: 'p1_t2', type: 'word', text: 'åŒå­¦', pinyin: 'tÃ³ng xuÃ©', icon: 'ğŸ’' },
            { id: 'p1_t3', type: 'word', text: 'å¹¼å„¿å›­', pinyin: 'yÃ²u Ã©r yuÃ¡n', icon: 'ğŸ«' },
            { id: 'p1_s1', type: 'sentence', text: 'è¿™æ˜¯æˆ‘çš„å¹¼å„¿å›­ã€‚', pinyin: 'zhÃ¨ shÃ¬ wÇ’ de yÃ²u Ã©r yuÃ¡n', icon: 'ğŸ–¼ï¸' },
            // P2
            { id: 'p2_t1', type: 'word', text: 'è¯¾å®¤', pinyin: 'kÃ¨ shÃ¬', icon: 'ğŸ–ï¸' },
            { id: 'p2_t2', type: 'word', text: 'ç”µè„‘å®¤', pinyin: 'diÃ n nÇo shÃ¬', icon: 'ğŸ’»' },
            { id: 'p2_s1', type: 'sentence', text: 'å¹¼å„¿å›­é‡Œæœ‰è¯¾å®¤ã€‚', pinyin: 'yÃ²u Ã©r yuÃ¡n lÇ yÇ’u kÃ¨ shÃ¬', icon: 'ğŸ ' },
            // P3
            { id: 'p3_t1', type: 'word', text: 'æ¸¸ä¹åœº', pinyin: 'yÃ³u lÃ¨ chÇng', icon: 'ğŸ¡' },
            { id: 'p3_t2', type: 'word', text: 'ç¤¼å ‚', pinyin: 'lÇ tÃ¡ng', icon: 'ğŸ¤' },
            { id: 'p3_s1', type: 'sentence', text: 'æ¸¸ä¹åœºæ—è¾¹æœ‰å•æ‰€ã€‚', pinyin: 'yÃ³u lÃ¨ chÇng pÃ¡ng biÄn yÇ’u cÃ¨ suÇ’', icon: 'ğŸš»' },
            // P4
            { id: 'p4_t1', type: 'word', text: 'å›­é•¿', pinyin: 'yuÃ¡n zhÇng', icon: 'ğŸ‘¨â€ğŸ’¼' },
            { id: 'p4_s1', type: 'sentence', text: 'è¯¾å®¤é‡Œæœ‰åŒå­¦ã€‚', pinyin: 'kÃ¨ shÃ¬ lÇ yÇ’u tÃ³ng xuÃ©', icon: 'ğŸ‘¨â€ğŸ‘©â€ğŸ‘§â€ğŸ‘¦' },
            // P5
            { id: 'p5_t1', type: 'word', text: 'æ ¡è½¦å¸æœº', pinyin: 'xiÃ o chÄ“ sÄ« jÄ«', icon: 'ğŸšŒ' },
            { id: 'p5_s1', type: 'sentence', text: 'æ ¡è½¦å¸æœºæ¥é€æˆ‘ä»¬ã€‚', pinyin: 'xiÃ o chÄ“ sÄ« jÄ« jiÄ“ sÃ²ng wÇ’ men', icon: 'ğŸ‘‹' }
        ];

        // æ¸¸æˆé…ç½®
        let quiz1State = { currentIdx: 0, questions: [] };
        let quiz2State = { currentIdx: 0, questions: [] };

        // --- å·¥å…·å‡½æ•° ---
        
        // è¯­éŸ³æ’­æŠ¥
        function speak(text, callback) {
            window.speechSynthesis.cancel();
            const utterance = new SpeechSynthesisUtterance(text);
            utterance.lang = 'zh-CN'; // å¼ºåˆ¶ä¸­æ–‡
            utterance.rate = 0.85; // è¯­é€Ÿé€‚ä¸­
            if (callback) utterance.onend = callback;
            window.speechSynthesis.speak(utterance);
        }

        // åˆ‡æ¢å±å¹•
        function goToScreen(screenId) {
            document.querySelectorAll('.screen-container').forEach(el => el.classList.remove('active'));
            document.getElementById(screenId).classList.add('active');
            
            // æ ¹æ®å±å¹•è‡ªåŠ¨è§¦å‘è¯­éŸ³
            if (screenId === 'screen-intro') speak("å—¨æ¢“è¾°ï¼Œæˆ‘æ˜¯ä½ çš„åè¯­å°è€å¸ˆ");
            if (screenId === 'screen-learn') speak("ç‚¹ä¸€ç‚¹å¡ç‰‡ï¼Œå¬å¬è€å¸ˆæ€ä¹ˆè¯»");
            if (screenId === 'screen-outro') speak("æ¢“è¾°çœŸæ£’ï¼ŒæŒ‘æˆ˜æˆåŠŸå•¦ï¼");
        }

        // --- æ ¸å¿ƒé€»è¾‘ ---

        // 1. åˆå§‹åŒ–å­¦ä¹ å¡ç‰‡
        function initLearnScreen() {
            const container = document.getElementById('learn-grid');
            lessonData.forEach(item => {
                const card = document.createElement('div');
                card.className = 'learn-card';
                // åˆ¤æ–­æ˜¯è¯è¯­è¿˜æ˜¯å¥å­ï¼Œè°ƒæ•´æ˜¾ç¤ºæ–¹å¼
                const iconDisplay = item.type === 'word' ? item.icon : 'ğŸ”Š';
                card.innerHTML = `
                    <span class="card-icon">${iconDisplay}</span>
                    <div class="card-text" style="${item.type==='sentence'?'font-size:1em':''}">${item.text}</div>
                    <div class="card-pinyin" style="${item.type==='sentence'?'display:none':''}">${item.pinyin}</div>
                `;
                card.onclick = () => {
                    card.classList.add('playing');
                    speak(item.text, () => card.classList.remove('playing'));
                };
                container.appendChild(card);
            });
        }

        // 2. åˆå§‹åŒ–æ¸¸æˆä¸€ï¼ˆé€‰æ‹©é¢˜ï¼‰
        function startGame1() {
            // ç­›é€‰å‡ºæ‰€æœ‰çš„â€œè¯è¯­â€ç”¨äºå‡ºé¢˜
            const words = lessonData.filter(item => item.type === 'word');
            // éšæœºæŒ‘é€‰3ä¸ªä½œä¸ºé¢˜ç›®
            quiz1State.questions = words.sort(() => 0.5 - Math.random()).slice(0, 3);
            quiz1State.currentIdx = 0;
            speak("æŒ‘æˆ˜ä¸€å¼€å§‹å•¦ï¼Œçœ‹å›¾ç‰‡ï¼Œé€‰å‡ºæ­£ç¡®çš„è¯è¯­");
            goToScreen('screen-game1');
            loadQuiz1Question();
        }

        function loadQuiz1Question() {
            if (quiz1State.currentIdx >= quiz1State.questions.length) {
                setTimeout(startGame2, 1500); // è¿›å…¥ä¸‹ä¸€ä¸ªæ¸¸æˆ
                return;
            }
            const q = quiz1State.questions[quiz1State.currentIdx];
            document.getElementById('quiz-target-icon').innerText = q.icon;
            document.getElementById('quiz1-feedback').innerText = ''; document.getElementById('quiz1-feedback').style.color = '#333';
            
            const optionsArea = document.getElementById('quiz-options-area');
            optionsArea.innerHTML = '';

            // ç”Ÿæˆä¸€ä¸ªé”™è¯¯é€‰é¡¹
            const allOtherWords = lessonData.filter(i => i.type === 'word' && i.text !== q.text);
            const wrongOptionStr = allOtherWords[Math.floor(Math.random() * allOtherWords.length)].text;
            
            let options = [q.text, wrongOptionStr];
            options.sort(() => 0.5 - Math.random()); // æ‰“ä¹±é¡ºåº

            options.forEach(optText => {
                const btn = document.createElement('button');
                btn.className = 'quiz-btn';
                btn.innerText = optText;
                btn.onclick = () => checkQuiz1(btn, optText, q.text);
                optionsArea.appendChild(btn);
            });
        }

        function checkQuiz1(btn, selected, correct) {
            if (selected === correct) {
                btn.classList.add('correct');
                document.getElementById('quiz1-feedback').innerText = 'ğŸ‰ ç­”å¯¹å•¦ï¼æ¢“è¾°çœŸæ£’ï¼';
                document.getElementById('quiz1-feedback').style.color = 'green';
                speak('ç­”å¯¹å•¦', () => {
                   quiz1State.currentIdx++;
                   setTimeout(loadQuiz1Question, 1000);
                });
            } else {
                btn.classList.add('wrong');
                document.getElementById('quiz1-feedback').innerText = 'ğŸ¤” ä¸å¯¹å“¦ï¼Œå†æƒ³æƒ³ã€‚';
                document.getElementById('quiz1-feedback').style.color = 'red';
                speak('ä¸å¯¹å“¦');
            }
        }

        // 3. åˆå§‹åŒ–æ¸¸æˆäºŒï¼ˆç»„å¥ï¼‰
        function startGame2() {
             // æ‰‹åŠ¨å®šä¹‰è¦è€ƒå¯Ÿçš„å¥å­å’Œåˆ†è¯ç»“æ„
             quiz2State.questions = [
                { full: 'è¿™æ˜¯æˆ‘çš„å¹¼å„¿å›­ã€‚', parts: ['è¿™æ˜¯', 'æˆ‘çš„', 'å¹¼å„¿å›­ã€‚'] },
                { full: 'å¹¼å„¿å›­é‡Œæœ‰è¯¾å®¤ã€‚', parts: ['å¹¼å„¿å›­', 'é‡Œæœ‰', 'è¯¾å®¤ã€‚'] },
                { full: 'æ ¡è½¦å¸æœºæ¥é€æˆ‘ä»¬ã€‚', parts: ['æ ¡è½¦å¸æœº', 'æ¥é€', 'æˆ‘ä»¬ã€‚'] }
            ];
            quiz2State.currentIdx = 0;
            speak("æŒ‘æˆ˜äºŒï¼ŒæŠŠæ‰“ä¹±çš„è¯è¯­æ’æˆé€šé¡ºçš„å¥å­");
            goToScreen('screen-game2');
            loadQuiz2Question();
        }

        function loadQuiz2Question() {
            if (quiz2State.currentIdx >= quiz2State.questions.length) {
                setTimeout(() => goToScreen('screen-outro'), 1500); // å…¨éƒ¨é€šå…³
                return;
            }
            const q = quiz2State.questions[quiz2State.currentIdx];
            document.getElementById('quiz2-feedback').innerText = ''; document.getElementById('quiz2-feedback').style.color = '#333';
            const pool = document.getElementById('sentence-pool');
            const target = document.getElementById('sentence-target');
            pool.innerHTML = ''; target.innerHTML = '';

            // æ‰“ä¹±è¯å—å¹¶ç”Ÿæˆå¯ç‚¹å‡»çš„æ–¹å—
            [...q.parts].sort(() => 0.5 - Math.random()).forEach(word => {
                const tile = document.createElement('div');
                tile.className = 'word-tile';
                tile.innerText = word;
                // ç‚¹å‡»åœ¨ä¸¤ä¸ªåŒºåŸŸé—´ç§»åŠ¨
                tile.onclick = function() {
                    if (this.parentElement === pool) target.appendChild(this);
                    else pool.appendChild(this);
                    speak(this.innerText); // ç‚¹å‡»æ—¶è¯»å‡ºå£°éŸ³è¾…åŠ©è®°å¿†
                };
                pool.appendChild(tile);
            });
        }

        function checkSentence() {
            const q = quiz2State.questions[quiz2State.currentIdx];
            // è·å–ç”¨æˆ·æ’åˆ—çš„æ–‡æœ¬
            const userSentence = Array.from(document.getElementById('sentence-target').children)
                .map(el => el.innerText).join('');
            
            if (userSentence === q.full) {
                document.getElementById('quiz2-feedback').innerText = 'ğŸŒŸ æ’å¯¹å•¦ï¼å®Œç¾ï¼';
                document.getElementById('quiz2-feedback').style.color = 'green';
                 speak('æ’å¯¹å•¦ï¼å®Œç¾ï¼', () => {
                   quiz2State.currentIdx++;
                   setTimeout(loadQuiz2Question, 1500);
                });
            } else {
                document.getElementById('quiz2-feedback').innerText = 'ğŸ’¬ é¡ºåºå¥½åƒä¸å¤ªé€šé¡ºå“¦ï¼Œå†è¯•è¯•ï¼Ÿ';
                document.getElementById('quiz2-feedback').style.color = 'red';
                speak('é¡ºåºå¥½åƒä¸å¤ªé€šé¡ºå“¦');
            }
        }

        // --- å…¥å£ ---
        window.onload = function() {
            initLearnScreen();
            goToScreen('screen-intro'); // å¯åŠ¨å¼€åœº
        };

    </script>
</body>
</html>
